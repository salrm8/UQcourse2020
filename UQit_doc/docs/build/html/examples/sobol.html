

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sobol Sensitivity Indices &mdash; UQit 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> UQit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/instl_dep.html">Installation and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/codes_list.html">List of core codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/terminology.html">Overview &amp; Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/sampling.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/surrogate.html">Surrogates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/uqFWD.html">UQ Forward Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/gsa.html">Global Sensitivity Analysis (GSA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UQit_core_/others.html">Other Core Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bib.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">UQit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Sobol Sensitivity Indices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/sobol.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Sobol-Sensitivity-Indices">
<h1>Sobol Sensitivity Indices<a class="headerlink" href="#Sobol-Sensitivity-Indices" title="Permalink to this headline">¶</a></h1>
<p>Saleh Rezaeiravesh, <a class="reference external" href="mailto:salehr&#37;&#52;&#48;kth&#46;se">salehr<span>&#64;</span>kth<span>&#46;</span>se</a> SimEx/FLOW, Engineering Mechanics, KTH Royal Institute of Technology, Stockholm, Sweden</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">mt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">UQit.sobol</span> <span class="kn">import</span> <span class="n">sobol</span>
<span class="kn">import</span> <span class="nn">UQit.analyticTestFuncs</span> <span class="k">as</span> <span class="nn">analyticTestFuncs</span>
<span class="kn">from</span> <span class="nn">UQit.pce</span> <span class="kn">import</span> <span class="n">pce</span><span class="p">,</span> <span class="n">pceEval</span>
<span class="kn">import</span> <span class="nn">UQit.reshaper</span> <span class="k">as</span> <span class="nn">reshaper</span>
<span class="kn">import</span> <span class="nn">UQit.sampling</span> <span class="k">as</span> <span class="nn">sampling</span>
</pre></div>
</div>
</div>
<div class="section" id="Example-1:-Sobol-indices-for-2-uniform-parameters">
<h2>Example 1: Sobol indices for 2 uniform parameters<a class="headerlink" href="#Example-1:-Sobol-indices-for-2-uniform-parameters" title="Permalink to this headline">¶</a></h2>
<p>Consider the following analytical function,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
f(\mathbf{q}) = q_1^2+q_1 q_2
\label{eq:1dModel}\tag{3}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{q}=\{q_1,q_2\}\)</span>, and both parameters are random with uniform distributions, i.e., <span class="math notranslate nohighlight">\(q_1\sim \mathcal{U}[\mathbb{Q}_1]\)</span> and <span class="math notranslate nohighlight">\(q_2\sim \mathcal{U}[\mathbb{Q}_2]\)</span>. The aim is to compute the main Sobol indices using <code class="docutils literal notranslate"><span class="pre">UQit</span></code> and validate them with the analytical values..</p>
<p>The above model function (simulator) is implemented in <code class="docutils literal notranslate"><span class="pre">analyticTestFuncs.fEx2D</span></code> with keyword <code class="docutils literal notranslate"><span class="pre">type3</span></code>.</p>
<p><strong>Step 1:</strong> Set the number of samples for <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span> and their associated admissible spaces <span class="math notranslate nohighlight">\(\mathbb{Q}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbb{Q}_2\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>       <span class="c1">#number of samples for q1 and q2</span>
<span class="n">qBound</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>   <span class="c1">#admissible space of q1 and q2</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<p><strong>Step 2:</strong> Generate samples for parameters <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span>. We choose to have samples to be uniformly spaced over the parameter spaces.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pdf</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p><strong>Step 3:</strong> Run the simulator (3) at the parameter samples to generate training model outputs. We assume that a 2D sample parameter is obtained by tensor product of the samples for <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fEx_</span><span class="o">=</span><span class="n">analyticTestFuncs</span><span class="o">.</span><span class="n">fEx2D</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;type3&#39;</span><span class="p">,</span><span class="s1">&#39;tensorProd&#39;</span><span class="p">)</span>
<span class="n">fEx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fEx_</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Step 4:</strong> Compute first- and second-order main and also total Sobol sensitivity indices:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sobol_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fEx</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">Si</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">STi</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">STi</span>
<span class="n">Sij</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Sij</span>
</pre></div>
</div>
</div>
<p><strong>Step 5:</strong> Validate the computed Sobol indices through comparison with the analytical values. To this end, we have derived expressions to compute the exact Sobol indices for the above model function. Note that, in general since the exact form of the model function (simulator) is not known, exact Sobol indices can not be evaluated.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fEx_</span><span class="o">.</span><span class="n">sobol</span><span class="p">(</span><span class="n">qBound</span><span class="p">)</span>
<span class="n">Si_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">STi_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">STi</span>
<span class="n">Sij_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">Sij</span>
</pre></div>
</div>
</div>
<p><strong>Results:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Main indices by UQit:</span><span class="se">\n\t</span><span class="s1"> S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S12=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Analytical main Indices:</span><span class="se">\n\t</span><span class="s1"> S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S12=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Main indices by UQit:
         S1=0.716474, S2=0.121511, S12=0.162015
Analytical main Indices:
         S1=0.716472, S2=0.121512, S12=0.162016
</pre></div></div>
</div>
<p><strong>Extra:</strong> In the above example, all the required samples to compute the Sobol indices were drawn directly from the simulator. This can be the case when running the simulator is computationally inexpensive. But in practice, we need to deal with the cases where the computational cost of running the simulator limits the number of training samples. In such situations, we need to construct a surrogate based on a limited number of training data and then use the surrogate to compute the Sobol indices.</p>
<p>Following this procedure, we repeat the previous example.</p>
<p><strong>Step 1:</strong> Draw a few samples to construct the PCE surrogate. We choose to have the parameter samples to be Gauss-Legendre points. The simulator is run at these parameter samples.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nQpce</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>    <span class="c1">#number of samples from q1, q2 to construct surrogate</span>
<span class="n">xi</span><span class="o">=</span><span class="p">[]</span>
<span class="n">qpce</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">samps</span><span class="o">=</span><span class="n">sampling</span><span class="o">.</span><span class="n">trainSample</span><span class="p">(</span><span class="n">sampleType</span><span class="o">=</span><span class="s1">&#39;GQ&#39;</span><span class="p">,</span><span class="n">GQdistType</span><span class="o">=</span><span class="s1">&#39;Unif&#39;</span><span class="p">,</span><span class="n">qInfo</span><span class="o">=</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nSamp</span><span class="o">=</span><span class="n">nQpce</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">xi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">samps</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span>
    <span class="n">qpce</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">samps</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="n">fVal_pceCnstrct</span><span class="o">=</span><span class="n">analyticTestFuncs</span><span class="o">.</span><span class="n">fEx2D</span><span class="p">(</span><span class="n">qpce</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">qpce</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;type3&#39;</span><span class="p">,</span><span class="s1">&#39;tensorProd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">val</span>
</pre></div>
</div>
</div>
<p><strong>Step 2:</strong> Construct the PCE surrogate</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xiGrid</span><span class="o">=</span><span class="n">reshaper</span><span class="o">.</span><span class="n">vecs2grid</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<span class="n">pceDict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;sampleType&#39;</span><span class="p">:</span><span class="s1">&#39;GQ&#39;</span><span class="p">,</span><span class="s1">&#39;truncMethod&#39;</span><span class="p">:</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="s1">&#39;pceSolveMethod&#39;</span><span class="p">:</span><span class="s1">&#39;Projection&#39;</span><span class="p">,</span>
             <span class="s1">&#39;distType&#39;</span><span class="p">:[</span><span class="s1">&#39;Unif&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">}</span>
<span class="n">pce_</span><span class="o">=</span><span class="n">pce</span><span class="p">(</span><span class="n">fVal</span><span class="o">=</span><span class="n">fVal_pceCnstrct</span><span class="p">,</span><span class="n">nQList</span><span class="o">=</span><span class="n">nQpce</span><span class="p">,</span><span class="n">xi</span><span class="o">=</span><span class="n">xiGrid</span><span class="p">,</span><span class="n">pceDict</span><span class="o">=</span><span class="n">pceDict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
... A gPCE for a 2-D parameter space is constructed.
...... Samples in each direction are Gauss Quadrature nodes (User should check this!).
...... PCE truncation method: TP
...... Method of computing PCE coefficients: Projection
...... Number of terms in PCE, K=  30
...... Number of Data point, n=  30
</pre></div></div>
</div>
<p><strong>Step 3:</strong> Run the surrogate at test samples which are used to compute the Sobol indices. The test samples are taken from <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qpceTest</span><span class="o">=</span><span class="p">[]</span>
<span class="n">xiTest</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">testSamps</span><span class="o">=</span><span class="n">sampling</span><span class="o">.</span><span class="n">testSample</span><span class="p">(</span><span class="s1">&#39;unifSpaced&#39;</span><span class="p">,</span><span class="n">GQdistType</span><span class="o">=</span><span class="s1">&#39;Unif&#39;</span><span class="p">,</span><span class="n">qBound</span><span class="o">=</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">nSamp</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">xiTest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">testSamps</span><span class="o">.</span><span class="n">xi</span><span class="p">)</span>
    <span class="n">qpceTest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">testSamps</span><span class="o">.</span><span class="n">q</span><span class="p">)</span>
<span class="n">fPCETest_</span><span class="o">=</span><span class="n">pceEval</span><span class="p">(</span><span class="n">coefs</span><span class="o">=</span><span class="n">pce_</span><span class="o">.</span><span class="n">coefs</span><span class="p">,</span><span class="n">kSet</span><span class="o">=</span><span class="n">pce_</span><span class="o">.</span><span class="n">kSet</span><span class="p">,</span><span class="n">xi</span><span class="o">=</span><span class="n">xiTest</span><span class="p">,</span><span class="n">distType</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Unif&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fPCETest</span><span class="o">=</span><span class="n">fPCETest_</span><span class="o">.</span><span class="n">pceVal</span>
</pre></div>
</div>
</div>
<p><strong>Step 4:</strong> Compute the Sobol indices using the surrogate values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sobolPCE_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">qpceTest</span><span class="p">,</span><span class="n">fPCETest</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">Si_pce</span><span class="o">=</span><span class="n">sobolPCE_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">Sij_pce</span><span class="o">=</span><span class="n">sobolPCE_</span><span class="o">.</span><span class="n">Sij</span>
</pre></div>
</div>
</div>
<p>We can validate the computed indices by comparing them to the values resulted from the previous example (where actual simulator is used).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Indices by the surrogate:</span><span class="se">\n\t</span><span class="s1"> S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S12=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si_pce</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si_pce</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij_pce</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Indices by the surrogate:
         S1=0.716474, S2=0.121511, S12=0.162015
</pre></div></div>
</div>
</div>
<div class="section" id="Example-2:-Sobol-indices-for-2-parameters-with-Gaussian-distributions">
<h2>Example 2: Sobol indices for 2 parameters with Gaussian distributions<a class="headerlink" href="#Example-2:-Sobol-indices-for-2-parameters-with-Gaussian-distributions" title="Permalink to this headline">¶</a></h2>
<p>Let’s do Example 15.7 in <a class="reference external" href="https://rsmith.math.ncsu.edu/UQ_TIA/">Smith</a>.</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{q})=c_1 q_1 +c_2 q_2\]</div>
<p>where <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> are constant parameters, and <span class="math notranslate nohighlight">\(q_i\sim\mathcal{N}(0,\sigma_i^2)\)</span> for <span class="math notranslate nohighlight">\(i=1,2\)</span>. For different values of <span class="math notranslate nohighlight">\(c_1,\,c_2,\,\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_2\)</span>, we can compare the Sobol indices computed by <code class="docutils literal notranslate"><span class="pre">UQit</span></code> and associted exact values.</p>
<p>Settings:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>        <span class="c1">#number of samples for q1 and q2</span>
<span class="n">qBound</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span>   <span class="c1">#admissible range of parameters</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">sig</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Generate uniformly-spaced values for the parameters; construct and plot the PDFs (probability density functions).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pdf</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">pdf_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">mt</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdf_</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">pdf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of q&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_sobol_32_0.png" src="../_images/examples_sobol_32_0.png" />
</div>
</div>
<p>Compute the function values at the samples</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fEx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">fEx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Compute the Sobol indices</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sobol_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fEx</span><span class="p">,</span><span class="n">pdf</span><span class="o">=</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">Si</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">STi</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">STi</span>
<span class="n">Sij</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Sij</span>
</pre></div>
</div>
</div>
<p>Validate the computed indices against corresponding exact values</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Si_ex</span><span class="o">=</span><span class="p">[(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
           <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">Sij_ex</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Main Indices by UQit:</span><span class="se">\n\t</span><span class="s1"> S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S12=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Main Analytical Reference:</span><span class="se">\n\t</span><span class="s1"> S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S12=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 &gt; Main Indices by UQit:
         S1=0.307692, S2=0.692308, S12=1.93492e-22
 &gt; Main Analytical Reference:
         S1=0.307692, S2=0.692308, S12=0
</pre></div></div>
</div>
</div>
<div class="section" id="Example-3:-Sobol-indices-for-3-uniform-parameters">
<h2>Example 3: Sobol indices for 3 uniform parameters<a class="headerlink" href="#Example-3:-Sobol-indices-for-3-uniform-parameters" title="Permalink to this headline">¶</a></h2>
<p>Consider the following analytical function,</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
f(\mathbf{q}) = \sin(q_1)+a\sin^2(q_2)+b\,q_3^4\sin(q_1) \,,
\label{eq:ishigami}\tag{4}
\end{equation}\]</div>
<p>which is called <a class="reference external" href="https://inis.iaea.org/search/search.aspx?orig_q=RN:21024954">Ishigami</a> function and widely used to validate different methods in UQ.</p>
<p>Here, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are two fixed parameters and the uncertain parameters <span class="math notranslate nohighlight">\(\mathbf{q}=\{q_1,q_2,q_3\}\)</span> have uniform distributions over the same range: <span class="math notranslate nohighlight">\(q_i\sim \mathcal{U}[-\pi,\pi]\,,\quad i=1,2,3\)</span>. The aim is to compute the main Sobol indices using <code class="docutils literal notranslate"><span class="pre">UQit</span></code> and validate them with the analytical values.</p>
<p>The given model function (simulator) is implemented in <code class="docutils literal notranslate"><span class="pre">analyticTestFuncs.fEx3D</span></code> with keyword <code class="docutils literal notranslate"><span class="pre">Ishigami</span></code>.</p>
<p>Set the number of samples for <span class="math notranslate nohighlight">\(q_1\)</span>, <span class="math notranslate nohighlight">\(q_2\)</span> and <span class="math notranslate nohighlight">\(q_3\)</span> and their associated admissible spaces <span class="math notranslate nohighlight">\(\mathbb{Q}_1\)</span>, <span class="math notranslate nohighlight">\(\mathbb{Q}_2\)</span> and <span class="math notranslate nohighlight">\(\mathbb{Q}_3\)</span>. Also set the model’s fixed parameters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>        <span class="c1">#number of samples for q1, q2, q3</span>
<span class="n">qBound</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span>      <span class="c1">#admissible space of the parameters</span>
        <span class="p">[</span><span class="o">-</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">]]</span>
<span class="n">a</span><span class="o">=</span><span class="mi">7</span>
<span class="n">b</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>
</div>
</div>
<p>Generate uniformly-spaced samples for parameters <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span>. Also define the PDFs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pdf</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p><strong>Step 4:</strong> Run the simulator (4) at the parameter samples to generate training model outputs. We assume that a 3D sample parameter is obtained by tensor-product of the samples for <span class="math notranslate nohighlight">\(q_1\)</span>, <span class="math notranslate nohighlight">\(q_2\)</span> and <span class="math notranslate nohighlight">\(q_3\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fEx_</span><span class="o">=</span><span class="n">analyticTestFuncs</span><span class="o">.</span><span class="n">fEx3D</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;Ishigami&#39;</span><span class="p">,</span><span class="s1">&#39;tensorProd&#39;</span><span class="p">,{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="n">b</span><span class="p">})</span>
<span class="n">fEx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">fEx_</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Compute first- and second-order main Sobol sensitivity indices using <code class="docutils literal notranslate"><span class="pre">UQit</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sobol_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fEx</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">Si</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">Sij</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Sij</span>
<span class="n">SijName</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">SijName</span>
<span class="n">STi</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">STi</span>
</pre></div>
</div>
</div>
<p>Validate the computed Sobol indices through comparison with the analytical values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fEx_</span><span class="o">.</span><span class="n">sobol</span><span class="p">(</span><span class="n">qBound</span><span class="p">)</span>
<span class="n">Si_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">STi_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">STi</span>
<span class="n">Sij_ex</span><span class="o">=</span><span class="n">fEx_</span><span class="o">.</span><span class="n">Sij</span>
</pre></div>
</div>
</div>
<p><strong>Results:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#UQit</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Main Indices by UQit : S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S3=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Si</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt;                        S12=</span><span class="si">%g</span><span class="s1">, S13=</span><span class="si">%g</span><span class="s1">, S23=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Sij</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Sij</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Total Indices        : ST1=</span><span class="si">%g</span><span class="s1">, ST2=</span><span class="si">%g</span><span class="s1">, ST3=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">STi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">STi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">STi</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="c1">#Reference</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Main Analytical Reference: S1=</span><span class="si">%g</span><span class="s1">, S2=</span><span class="si">%g</span><span class="s1">, S3=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Si_ex</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt;                           S12=</span><span class="si">%g</span><span class="s1">, S13=</span><span class="si">%g</span><span class="s1">, S23=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">Sij_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Sij_ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Sij_ex</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &gt; Total Indices            : ST1=</span><span class="si">%g</span><span class="s1">, ST2=</span><span class="si">%g</span><span class="s1">, ST3=</span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">STi_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">STi_ex</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">STi_ex</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 &gt; Main Indices by UQit : S1=0.313905, S2=0.442312, S3=5.64351e-32
 &gt;                        S12=9.90498e-32, S13=0.243783, S23=8.41268e-32
 &gt; Total Indices        : ST1=0.557688, ST2=0.442312, ST3=0.243783
 &gt; Main Analytical Reference: S1=0.313905, S2=0.442411, S3=0
 &gt;                           S12=0, S13=0.243684, S23=0
 &gt; Total Indices            : ST1=0.557589, ST2=0.442411, ST3=0.243684
</pre></div></div>
</div>
</div>
<div class="section" id="Example-4:-Sobol-indices-for-4-parameters-with-Gaussian-distributions">
<h2>Example 4: Sobol indices for 4 parameters with Gaussian distributions<a class="headerlink" href="#Example-4:-Sobol-indices-for-4-parameters-with-Gaussian-distributions" title="Permalink to this headline">¶</a></h2>
<p>Let’s do Example 15.8 in <a class="reference external" href="https://rsmith.math.ncsu.edu/UQ_TIA/">Smith</a>.</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{q})=q_1 q_3 +q_2 q_4\]</div>
<p>where <span class="math notranslate nohighlight">\(q_i\sim\mathcal{N}(0,\sigma_i^2)\)</span> for <span class="math notranslate nohighlight">\(i=1,2,3,4\)</span>. For different values of <span class="math notranslate nohighlight">\(\sigma_i\)</span>, we can compare the Sobol indices computed by <code class="docutils literal notranslate"><span class="pre">UQit</span></code> with associted exact values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Settings</span>
<span class="n">n</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">]</span>       <span class="c1">#number of samples for q1 and q2, Method1</span>
<span class="n">qBound</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">]]</span><span class="o">*</span><span class="mi">4</span>   <span class="c1">#admissible range of parameters</span>
<span class="n">sig</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>    <span class="c1">#sdev of q&#39;s</span>
<span class="c1">#(1) Samples from parameters space + the PDFs</span>
<span class="n">p</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pdf</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">pdf_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">mt</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mt</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdf_</span><span class="p">)</span>
<span class="c1">#plot PDfs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">pdf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of q&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#(2) Compute function value at the parameter samples</span>
<span class="n">fEx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">fEx</span><span class="p">[</span><span class="n">i0</span><span class="p">,</span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">,</span><span class="n">i3</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i0</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span><span class="o">+</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i1</span><span class="p">]</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i3</span><span class="p">]</span>
<span class="c1">#(3) Compute Sobol indices direct numerical integration</span>
<span class="n">sobol_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fEx</span><span class="p">,</span><span class="n">pdf</span><span class="o">=</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">Si</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Si</span>
<span class="n">STi</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">STi</span>
<span class="n">Sij</span><span class="o">=</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Sij</span>
<span class="c1">#(5) Exact Sobol indices (analytical expressions)</span>
<span class="n">Si_ex</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span>
<span class="n">Sij_ex</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,(</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">((</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">((</span><span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#(6) Results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; Main Indices Si by UQit:&#39;</span><span class="p">,</span><span class="n">Si</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Sij&#39;</span><span class="p">,</span><span class="n">Sij</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; Reference Analytical Si:&#39;</span><span class="p">,</span><span class="n">Si_ex</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Sij&#39;</span><span class="p">,</span><span class="n">Sij_ex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_sobol_55_0.png" src="../_images/examples_sobol_55_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; Main Indices Si by UQit: [5.69332163e-35 4.46886262e-34 3.05804326e-35 1.63131702e-33]
  Sij [1.24593888e-33 2.70270376e-02 1.20563049e-33 1.10254866e-33
 9.72972962e-01 9.90293824e-34]
&gt; Reference Analytical Si: [0, 0, 0, 0]
  Sij [0, 0.02702702702702703, 0, 0, 0.972972972972973, 0]
</pre></div></div>
</div>
</div>
<div class="section" id="Example-5:-Sobol-indices-for-arbitrary-number-of-parameters-with-uniform-distributions">
<h2>Example 5: Sobol indices for arbitrary number of parameters with uniform distributions<a class="headerlink" href="#Example-5:-Sobol-indices-for-arbitrary-number-of-parameters-with-uniform-distributions" title="Permalink to this headline">¶</a></h2>
<p>Here we consider the test case which is considered in the original article by <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0378475400002706">Sobol</a> as well as in Example 15.17 in <a class="reference external" href="https://rsmith.math.ncsu.edu/UQ_TIA/">Smith</a>:</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{q})=\prod_{i=1}^p g_i(q_i)\,,\quad g_i(q_i)=\frac{|4q_i-2|+a_i}{1+a_i}\,, a_i\geq 0\]</div>
<p>Assume <span class="math notranslate nohighlight">\(q_i\sim\mathcal{U}[0,1]\)</span> for <span class="math notranslate nohighlight">\(i=1,2,\cdots,p\)</span> for any <span class="math notranslate nohighlight">\(p&gt;1\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#---SETTINGS ---------------</span>
<span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.25</span><span class="p">]</span>   <span class="c1">#coefficients in the model =&gt; p is determined from the length of this list</span>
<span class="n">nSamp</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span>
<span class="c1">#---------------------------</span>
<span class="n">p</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">qBound</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="n">p</span>
<span class="c1">#Generate samples, compute PDFs and evaluate model response at the samples</span>
<span class="n">q</span><span class="o">=</span><span class="p">[]</span>
<span class="n">pdf</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">q_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">nSamp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nSamp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">qBound</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">fEx_</span><span class="o">=</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">q_</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
       <span class="n">fEx</span><span class="o">=</span><span class="n">fEx_</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="n">fEx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">fEx</span><span class="p">,</span><span class="n">fEx_</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#Computed Sobol indices</span>
<span class="n">sobol_</span><span class="o">=</span><span class="n">sobol</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">fEx</span><span class="p">,</span><span class="n">pdf</span><span class="p">)</span>
<span class="c1">#Exact reference Sobol indices (Smith, p.336)</span>
<span class="n">Di</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Dsum</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">Di</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mf">2.</span><span class="p">))</span>
    <span class="n">Dsum</span><span class="o">*=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">Di</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">Dsum</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="n">Dsum</span>
<span class="n">Di</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Di</span><span class="p">)</span>
<span class="n">Si</span><span class="o">=</span><span class="n">Di</span><span class="o">/</span><span class="n">Dsum</span>
<span class="n">Dij</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="n">j</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">:</span>
           <span class="n">Dij</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Di</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Di</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">Dij</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Dij</span><span class="p">)</span>
<span class="n">Sij</span><span class="o">=</span><span class="n">Dij</span><span class="o">/</span><span class="n">Dsum</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computed Indices by UQit:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Si:&#39;</span><span class="p">,</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Si</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Sij-Name:&#39;</span><span class="p">,</span><span class="n">sobol_</span><span class="o">.</span><span class="n">SijName</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Sij:&#39;</span><span class="p">,</span><span class="n">sobol_</span><span class="o">.</span><span class="n">Sij</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; STi:&#39;</span><span class="p">,</span><span class="n">sobol_</span><span class="o">.</span><span class="n">STi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exact Sobol Indices:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Si:&#39;</span><span class="p">,</span><span class="n">Si</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Sij:&#39;</span><span class="p">,</span><span class="n">Sij</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computed Indices by UQit:
 Si: [0.13445718 0.21002473 0.06285799 0.15448376 0.1947089 ]
 Sij-Name: [&#39;S12&#39;, &#39;S13&#39;, &#39;S14&#39;, &#39;S15&#39;, &#39;S23&#39;, &#39;S24&#39;, &#39;S25&#39;, &#39;S34&#39;, &#39;S35&#39;, &#39;S45&#39;]
 Sij: [0.0309405  0.00926014 0.0227583  0.0286842  0.01446451 0.0355489
 0.04480528 0.01063938 0.0134097  0.03295654]
 STi: [0.22610031 0.33578393 0.11063172 0.25638687 0.31456462]
Exact Sobol Indices:
 Si: [0.12932295 0.2020671  0.06011914 0.14845746 0.18622504]
 Sij: [0.02993587 0.00890654 0.0219937  0.0275889  0.01391647 0.03436515
 0.04310765 0.01022434 0.01282542 0.03167093]
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Saleh Rezaeiravesh

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>